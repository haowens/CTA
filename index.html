<!DOCTYPE html>
<html lang="en" data-version="1528749026774">
  <head>
    <title>Easier scrollytelling with position sticky</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
      name="description"
      content="Leaning on CSS to simplify the process."
    />
    <meta
      name="news_keywords"
      content="scrollytelling, position, sticky, css, graphic, interactive, data"
    />

    <link
      rel="canonical"
      href="https://pudding.cool/process/scrollytelling-sticky/"
    />
    <link rel="stylesheet" href="style.css">

    <!-- boilerplate.css -->

    
    <script src="https://unpkg.com/enter-view"></script>
	<script src="https://unpkg.com/d3@5.4.0/dist/d3.min.js"></script>
	<script src="https://unpkg.com/stickyfilljs@2.0.5/dist/stickyfill.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-tile@1"></script>
    
       
  </head>

  <body class="tk-publico">

    <main id="content">

      <!-- <figure class="sticky">
            <div id="route"></div>
      </figure>
      <section class="filler">
        <p>Scroll</p>
      </section> -->
<!-- 
      <section id="scrolly-side">
        <div class="scrolly">

          <article>
            <div class="step" data-width="10%" data-index="0">
              <p>Bar is 10%</p>
            </div>
            <div class="step" data-width="90%" data-index="1">
              <p>Bar is 90%</p>
            </div>
            <div class="step" data-width="50%" data-index="2">
              <p>Bar is 50%</p>
            </div>
          </article>


          <figure class="sticky">
            <div class="mainfig" id="mainfig">
     
            </div>
          </figure>
        </div>
      </section> -->

      <section id="scrolly-overlay">
        <figure class="sticky">
            <div id="route"></div>
        </figure>
        <section class="filler">
            <img src="train.jpg"/>
            <p style="color:black; width: 50%; font-size: 20px; margin-left: 25%; margin-top: 5%; margin-bottom: 0;">This story is entirely based on the story <a href="https://projects.two-n.com/mta/?utm=website#section-map-16">MTA Ridership Changes due to COVID-19</a> done by Aucher Serr and Two-N, all credit to them! I thought it was a brilliant premise and something to attempt replicating as a project for a data visualization design methods class. This story instead focuses on my city and public transportation system of interest: Chicago and the CTA.</p>
            <p style="color:black; width: 50%; font-size: 20px; margin-left: 25%; margin-bottom: 5%;">The pandemic has completely reshaped the infrastructuer of daily communal life in so many ways. The mass movement of an imagination-defying amount of tasks online feels like one of the most ubiquitous changes. This is, in many ways, huge for accessibility--that initial promise of the Internet.</p>
        </section>

        <div class="scrolly">
     
          <figure class="sticky">
            <div class="mainfig" id="mainfig">
                <!-- <div class="bar-inner"></div> -->
            </div>
          </figure>

          <!--  step text   -->
          <article>
            <div class="step" data-width="10%" data-index="0">
              <p>Let's look at ridership as a whole. Every bar represents a month from January 2020 through to October 2023, the most recent <a>data</a> published by the City of Chicago.</p>
            </div>
            <div class="step" data-width="90%" data-index="1">
              <p>Bar is 90%</p>
            </div>
            <div class="step" data-width="50%" data-index="2">
              <p>Bar is 50%</p>
            </div>
          </article>
        </div>
      </section>

      <section class="filler">
        <p>End</p>
      </section>
    </main>

    <script src="helpers.js"></script>

    <script>
      const container1 = d3.select("#scrolly-overlay");
      const stepSel1 = container1.selectAll(".step");

      function updateChart1(index) {
        const sel = container1.select(`[data-index='${index}']`);
        const width = sel.attr("data-width");
        stepSel1.classed("is-active", (d, i) => i === index);
        container1.select(".bar-inner").style("width", width);
      }

      function init1() {
        Stickyfill.add(d3.select(".sticky").node());
        initializeRoute();
        drawBarGraphBackground();
        
        enterView({
          selector: stepSel1.nodes(),
          offset: 0.5,
          enter: (el) => {
            const index = +d3.select(el).attr("data-index");
            console.log(index)
            stepSel1.classed("is-active", (d, i) => i === index);
            if (index === 0) {
                console.log("hey")
  
               
            } else if (index === 1) {
       
            } else if (index === 2) {
                removeBarsAndDrawMap()
            }
          },
          exit: (el) => {
            let index = +d3.select(el).attr("data-index");
            index = Math.max(0, index - 1);
            if (index === 0) {
    
            }
            stepSel1.classed("is-active", (d, i) => i === index);
          },
        });
      }

      init1();

    //   const container2 = d3.select("#scrolly-overlay");
    //   const stepSel2 = container2.selectAll(".step");

    //   function updateChart2(index) {
    //     const sel = container2.select(`[data-index='${index}']`);
    //     const width = sel.attr("data-width");
    //     stepSel2.classed("is-active", (d, i) => i === index);
    //     container2.select(".bar-inner").style("width", width);
    //   }

    //   function init2() {
    //     Stickyfill.add(d3.select(".sticky").node());

    //     enterView({
    //       selector: stepSel2.nodes(),
    //       offset: 0.5,
    //       enter: (el) => {
    //         const index = +d3.select(el).attr("data-index");
    //         updateChart2(index);
    //       },
    //       exit: (el) => {
    //         let index = +d3.select(el).attr("data-index");
    //         index = Math.max(0, index - 1);
    //         updateChart2(index);
    //       },
    //     });
    //   }

    //   init2();
    </script>
  </body>
</html>
